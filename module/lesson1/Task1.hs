module Module.Lesson1.Task1 where

import Control.Arrow ((>>>))

-- | Task #1
composeAll :: [a -> a] -> a -> a
composeAll = foldr (.) id

-- >>> composeAll [(^ 1), (^ 2), (^ 3)] 12
-- 2985984

-- | Task #2
flabbergast :: (a -> a, Int) -> a -> a
flabbergast = uncurry (flip replicate) >>> composeAll

-- >>> flabbergast (tail, 3) [1, 2, 3, 4, 5]
-- >>> flabbergast (map (^ 2), 10) [1, 2, 3]
-- [4,5]
-- [1,179769313486231590772930519078902473361797697894230657273430081157732675805500963132708477322407536021120113879871393357658789768814416622492847430639474124377767893424865485276302219601246094119453082952085005768838150682342462881473913110540827237163350510684586298239947245938479716304835356329624224137216,373391848741020043532959754184866588225409776783734007750636931722079040617265251229993688938803977220468765065431475158108727054592160858581351336982809187314191748594262580938807019951956404285571818041046681288797402925517668012340617298396574731619152386723046235125934896058590588284654793540505936202376547807442730582144527058988756251452817793413352141920744623027518729185432862375737063985485319476416926263819972887006907013899256524297198527698749274196276811060702333710356481]
